(function(){"use strict";angular.module("mopidyLuxApp",[]).config(["$routeProvider",function(a){return a.when("/library/:section",{templateUrl:"views/LibrarySection.html",controller:"LibrarySectionCtrl"}).when("/",{templateUrl:"views/LibrarySearch.html",controller:"LibrarySearchCtrl"}).otherwise({redirectTo:"/"})}])}).call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibrarySearchCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibrarySectionCtrl",["$scope","mopidy","$routeParams",function(a,b,c){var d;return a.section=c.section,d=function(){return"albums"===a.section&&b.getAlbums(function(b){return a.results=b}),"artists"===a.section?b.getArtists(function(b){return a.results=b}):void 0},b.isConnected()&&d(),b.on("state:online",function(){return d()})}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibraryCtrl",["$scope","mopidy","$route",function(){}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("PlayerCtrl",["$scope","mopidy",function(a,b){var c,d,e,f,g,h;return c=!1,e=function(b){return a.track_position_time=b,a.track_position=100*(a.track_position_time/a.track_length),f()},f=function(){return"playing"===a.state?(clearInterval(c),c=setTimeout(function(){return a.$apply(function(){return e(a.track_position_time+1500)})},1500)):clearInterval(c)},d=function(d){var f;return d?(a.track=d.name,a.artist=d.artists?d.artists[0].name:!1,a.album=d.album?d.album.name:!1,d.album.images?(f=d.album.images[0],a.cover=f):a.cover=!1,d.length?(a.track_length=d.length,b.getTimePosition(e)):(a.track_length=0,clearInterval(c))):(a.album=!1,a.artist=!1,a.cover=!1,a.track=!1,a.track_length=0,a.track_position=0,clearTimeout(c))},g=function(a){return d(a.tl_track.track),f()},h=function(b){return a.volume=b,a.volumeState=0===b?"muted":"unmuted"},b.on("event:trackPlaybackStarted",g),b.on("event:trackPlaybackPaused",g),b.on("event:trackPlaybackEnded",g),b.on("event:seeked",e),b.on("event:playbackStateChanged",function(c){return a.state=c.new_state,b.getTimePosition(e),console.log("$scope.state",a.state)}),b.on("event:volumeChanged",function(a){return h(a.volume)}),b.on("state:online",function(){return b.getCurrentTrack(d),b.getState(function(c){return a.state=c,b.getTimePosition(e)}),b.getVolume(function(a){return h(a)})}),a.seek=function(c){var d;return 0===c.button?(d=c.offsetX/c.currentTarget.clientWidth*a.track_length,b["native"].playback.seek(d),c.preventDefault()):void 0},a.play=function(){return b["native"].playback.play()},a.stop=function(){return b["native"].playback.stop()},a.pause=function(){return b["native"].playback.pause()},a.next=function(){return b["native"].playback.next()},a.prev=function(){return b["native"].playback.previous()},a.setVolume=function(a){var c;return 0===a.button?(c=100*(a.offsetX/a.currentTarget.clientWidth),b["native"].playback.setVolume(c),a.preventDefault()):void 0},a.mute=function(){return a.unmutedVolume=a.volume,b["native"].playback.setVolume(0)},a.unmute=function(){return b["native"].playback.setVolume(a.unmutedVolume)}}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("TracklistCtrl",["$scope","mopidy",function(a,b){var c,d;return c=function(){return b.getState(function(b){return a.state=b}),b.getTracklistPosition(function(b){return a.current_track=b})},d=function(){return b.getTracklist(function(b){var d,e,f,g,h,i;for(i=[],g=0;g<b.length;)h=b[g].track,e="",h.artists&&(e=h.artists[0].name),d=!1,h.album&&(d=h.album.name),f=!1,h.album.images&&(f=h.album.images[0],/sndcdn/.test(f)&&(f=f.replace("-large.jp","-t200x200.jp"))),i.push({tl_track:b[g],track:h.name,artist:e,album:d,cover:f,uri:h.uri,id:g}),g++;return a.tracks=i,c()})},a.tracks=[],a.play=function(c){return b.changeTrack(c),"playing"!==a.state?b["native"].playback.play():void 0},b.on("event:tracklistChanged",d),b.on("event:playbackStateChanged",c),b.on("state:online",function(){return d(),c()})}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").directive("ngHover",function(){return{link:function(a,b,c){return $(b).hover(function(){return $(this).addClass(c.ngHover)},function(){return $(this).removeClass(c.ngHover)})}}})}.call(this),function(){"use strict";angular.module("mopidyLuxApp").directive("scrollto",function(){return function(a,b,c){var d,e,f,g;return!a.$eval(c.scrollto)||(e=$(window).scrollTop(),d=e+$(window).height(),g=$(b).offset().top,f=g+$(b).height(),d>=f&&g>=e)?void 0:$(b).parent().scrollTop($(b)[0].offsetTop-30)}})}.call(this),function(){"use strict";angular.module("mopidyLuxApp").factory("mopidy",["$rootScope",function(a){var b,c,d,e,f;return b={albums:!1,artists:!1},c=function(b,c){return d.on(b,function(b){return a.$apply(function(){return c(b)})})},f=function(a){return"http://coverartarchive.org/release/"+a+"/front"},e=function(c){return b.artists&&b.albums?c(b.albums,b.artists):d.library.search().then(function(d){var e,f,g,h,i,j,k,l,m,n,o;for(e=[],f=[],k=0,m=d.length;m>k;k++)if(g=d[k],h=[],i=[],g.tracks)for(o=g.tracks,l=0,n=o.length;n>l;l++)j=o[l],_.contains(h,j.album.name)||(h.push(j.album.name),e.push({name:j.album.name,art:_.first(j.album.images),backend:g.uri,model:"album"})),_.contains(i,_.first(j.artists).name)||(i.push(_.first(j.artists).name),f.push({name:_.first(j.artists).name,art:_.first(j.album.images),backend:g.uri,model:"artist"}));return b.artists=f,b.albums=e,a.$apply(function(){return c(e,f)})})},d=new Mopidy,window.mop=d,c("state:online",function(){return a.isConnected=!0}),c("state:offline",function(){return a.isConnected=!1}),{isConnected:function(){return a.isConnected},on:c,emit:d.emit,"native":d,getCurrentTrack:function(b){return d.playback.getCurrentTrack().then(function(c){return a.$apply(function(){return b(c)})})},changeTrack:function(a){return d.playback.changeTrack(a)},getTracklistPosition:function(b){return d.playback.getTracklistPosition().then(function(c){return a.$apply(function(){return b(c)})})},getTracklist:function(b){return d.tracklist.getTlTracks().then(function(c){return a.$apply(function(){return b(c)})})},getState:function(b){return d.playback.getState().then(function(c){return a.$apply(function(){return b(c)})})},getVolume:function(b){return d.playback.getVolume().then(function(c){return a.$apply(function(){return b(c)})})},getTimePosition:function(b){return d.playback.getTimePosition().then(function(c){return a.$apply(function(){return b(c)})})},getAlbums:function(a){return e(function(b){return a(b)})},getArtists:function(a){return e(function(b,c){return a(c)})}}}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp",[]).config(["$routeProvider",function(a){return a.when("/library/:section",{templateUrl:"views/LibrarySection.html",controller:"LibrarySectionCtrl"}).when("/",{templateUrl:"views/LibrarySearch.html",controller:"LibrarySearchCtrl"}).otherwise({redirectTo:"/"})}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibrarySearchCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibrarySectionCtrl",["$scope","mopidy","$routeParams",function(a,b,c){var d;return a.section=c.section,d=function(){return"albums"===a.section&&b.getAlbums(function(b){return a.results=b}),"artists"===a.section?b.getArtists(function(b){return a.results=b}):void 0},b.isConnected()&&d(),b.on("state:online",function(){return d()})}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("LibraryCtrl",["$scope","mopidy","$route",function(){}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("PlayerCtrl",["$scope","mopidy",function(a,b){var c,d,e,f,g,h;return c=!1,e=function(b){return a.track_position_time=b,a.track_position=100*(a.track_position_time/a.track_length),f()},f=function(){return"playing"===a.state?(clearInterval(c),c=setTimeout(function(){return a.$apply(function(){return e(a.track_position_time+1500)})},1500)):clearInterval(c)},d=function(d){var f;return d?(a.track=d.name,a.artist=d.artists?d.artists[0].name:!1,a.album=d.album?d.album.name:!1,d.album.images?(f=d.album.images[0],a.cover=f):a.cover=!1,d.length?(a.track_length=d.length,b.getTimePosition(e)):(a.track_length=0,clearInterval(c))):(a.album=!1,a.artist=!1,a.cover=!1,a.track=!1,a.track_length=0,a.track_position=0,clearTimeout(c))},g=function(a){return d(a.tl_track.track),f()},h=function(b){return a.volume=b,a.volumeState=0===b?"muted":"unmuted"},b.on("event:trackPlaybackStarted",g),b.on("event:trackPlaybackPaused",g),b.on("event:trackPlaybackEnded",g),b.on("event:seeked",e),b.on("event:playbackStateChanged",function(c){return a.state=c.new_state,b.getTimePosition(e),console.log("$scope.state",a.state)}),b.on("event:volumeChanged",function(a){return h(a.volume)}),b.on("state:online",function(){return b.getCurrentTrack(d),b.getState(function(c){return a.state=c,b.getTimePosition(e)}),b.getVolume(function(a){return h(a)})}),a.seek=function(c){var d;return 0===c.button?(d=c.offsetX/c.currentTarget.clientWidth*a.track_length,b["native"].playback.seek(d),c.preventDefault()):void 0},a.play=function(){return b["native"].playback.play()},a.stop=function(){return b["native"].playback.stop()},a.pause=function(){return b["native"].playback.pause()},a.next=function(){return b["native"].playback.next()},a.prev=function(){return b["native"].playback.previous()},a.setVolume=function(a){var c;return 0===a.button?(c=100*(a.offsetX/a.currentTarget.clientWidth),b["native"].playback.setVolume(c),a.preventDefault()):void 0},a.mute=function(){return a.unmutedVolume=a.volume,b["native"].playback.setVolume(0)},a.unmute=function(){return b["native"].playback.setVolume(a.unmutedVolume)}}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").controller("TracklistCtrl",["$scope","mopidy",function(a,b){var c,d;return c=function(){return b.getState(function(b){return a.state=b}),b.getTracklistPosition(function(b){return a.current_track=b})},d=function(){return b.getTracklist(function(b){var d,e,f,g,h,i;for(i=[],g=0;g<b.length;)h=b[g].track,e="",h.artists&&(e=h.artists[0].name),d=!1,h.album&&(d=h.album.name),f=!1,h.album.images&&(f=h.album.images[0],/sndcdn/.test(f)&&(f=f.replace("-large.jp","-t200x200.jp"))),i.push({tl_track:b[g],track:h.name,artist:e,album:d,cover:f,uri:h.uri,id:g}),g++;return a.tracks=i,c()})},a.tracks=[],a.play=function(c){return b.changeTrack(c),"playing"!==a.state?b["native"].playback.play():void 0},b.on("event:tracklistChanged",d),b.on("event:playbackStateChanged",c),b.on("state:online",function(){return d(),c()})}])}.call(this),function(){"use strict";angular.module("mopidyLuxApp").directive("ngHover",function(){return{link:function(a,b,c){return $(b).hover(function(){return $(this).addClass(c.ngHover)},function(){return $(this).removeClass(c.ngHover)})}}})}.call(this),function(){"use strict";angular.module("mopidyLuxApp").directive("scrollto",function(){return function(a,b,c){var d,e,f,g;return!a.$eval(c.scrollto)||(e=$(window).scrollTop(),d=e+$(window).height(),g=$(b).offset().top,f=g+$(b).height(),d>=f&&g>=e)?void 0:$(b).parent().scrollTop($(b)[0].offsetTop-30)}})}.call(this),function(){"use strict";angular.module("mopidyLuxApp").factory("mopidy",["$rootScope",function(a){var b,c,d,e,f;return b={albums:!1,artists:!1},c=function(b,c){return d.on(b,function(b){return a.$apply(function(){return c(b)})})},f=function(a){return"http://coverartarchive.org/release/"+a+"/front"},e=function(c){return b.artists&&b.albums?c(b.albums,b.artists):d.library.search().then(function(d){var e,f,g,h,i,j,k,l,m,n,o;for(e=[],f=[],k=0,m=d.length;m>k;k++)if(g=d[k],h=[],i=[],g.tracks)for(o=g.tracks,l=0,n=o.length;n>l;l++)j=o[l],_.contains(h,j.album.name)||(h.push(j.album.name),e.push({name:j.album.name,art:_.first(j.album.images),backend:g.uri,model:"album"})),_.contains(i,_.first(j.artists).name)||(i.push(_.first(j.artists).name),f.push({name:_.first(j.artists).name,art:_.first(j.album.images),backend:g.uri,model:"artist"}));return b.artists=f,b.albums=e,a.$apply(function(){return c(e,f)})})},d=new Mopidy,window.mop=d,c("state:online",function(){return a.isConnected=!0}),c("state:offline",function(){return a.isConnected=!1}),{isConnected:function(){return a.isConnected},on:c,emit:d.emit,"native":d,getCurrentTrack:function(b){return d.playback.getCurrentTrack().then(function(c){return a.$apply(function(){return b(c)})})},changeTrack:function(a){return d.playback.changeTrack(a)},getTracklistPosition:function(b){return d.playback.getTracklistPosition().then(function(c){return a.$apply(function(){return b(c)})})},getTracklist:function(b){return d.tracklist.getTlTracks().then(function(c){return a.$apply(function(){return b(c)})})},getState:function(b){return d.playback.getState().then(function(c){return a.$apply(function(){return b(c)})})},getVolume:function(b){return d.playback.getVolume().then(function(c){return a.$apply(function(){return b(c)})})},getTimePosition:function(b){return d.playback.getTimePosition().then(function(c){return a.$apply(function(){return b(c)})})},getAlbums:function(a){return e(function(b){return a(b)})},getArtists:function(a){return e(function(b,c){return a(c)})}}}])}.call(this);