(function(){"use strict";angular.module("newSrcApp",["ngSanitize","ngRoute","mgcrea.ngStrap","config","pasvaz.bindonce"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/playlist.html",controller:"PlaylistCtrl"}).when("/browse/",{templateUrl:"views/browse.html",controller:"BrowseCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","ENV",function(a,b){return a.toplayer=function(){return $("#wrapper").toggleClass("active"),a.ui_state=!a.ui_state},a.$watch("title",function(){return angular.element("head title").text("development"===b.name?"Lux("+b.build+") - "+a.title:"Lux - "+a.title)})}])}).call(this),angular.module("config",[]).constant("ENV",{name:"production",build:"1.0.0-13-g721b10a"}),function(){"use strict";angular.module("newSrcApp").directive("bootswatch",function(){return{template:"<form><select>\n  <option ng-repeat=\"theme in ['amelia','cerulean','cosmo','cyborg','darkly','flatly','journal','lumen','readable','simplex','slate','spacelab','superhero','united','yeti']\" value=\"{{theme}}\">{{theme}}</option>\n</select></form>",restrict:"EA",link:function(a,b){return b.bind("change",function(a){return angular.element("head link:nth(0)").attr("href","//netdna.bootstrapcdn.com/bootswatch/3.1.1/"+a.target.value+"/bootstrap.min.css")})}}})}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SearchCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("DiscoverCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("BrowseCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlaylistCtrl",["$scope","Mopidy","$rootScope","$log",function(a,b,c){var d,e,f,g;return c.title="Playlist",f=function(a){var b;return $("table tbody tr").removeClass("active"),b=$("table tbody tr:eq("+a+")").addClass("active"),$("body").animate({scrollTop:b.offset().top-100},800)},a.$watch("indexNow",function(a){return a>=0?f(a):void 0}),e=function(c){return"playing"===c.new_state?b.getCurrentTlTrack(function(c){return b["native"].tracklist.index(c).then(function(b){return a.indexNow=b})}):void 0},g=function(){return b.getTracklist(function(b){return a.tracks=b})},a.pause=function(){return b["native"].playback.pause()},a.toggleMenu=function(){return $("#wrapper").toggleClass("active")},a.play=function(a){return b.changeTrack(a),b["native"].playback.play()},a.clear=function(){return b["native"].tracklist.clear()},d=function(){return g(),e({new_state:"playing"})},b.on("event:tracklistChanged",g),b.on("event:playbackStateChanged",e),b.on("state:online",d),c.isConnected&&d(),a.$on("$destroy",function(){return b.off("event:tracklistChanged",g),b.off("event:playbackStateChanged",e),b.off("state:online",d)})}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SettingsCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").factory("Mopidy",["$rootScope","ENV",function(a,b){var c,d,e,f;return c={albums:!1,artists:!1},d=function(b,c){return e.on(b,function(b){return a.$apply(function(){return c(b)})})},f=function(b){return c.artists&&c.albums?b(c.albums,c.artists):e.library.search().then(function(d){var e,f,g,h,i,j,k,l,m,n,o;for(e=[],f=[],k=0,m=d.length;m>k;k++)if(g=d[k],h=[],i=[],g.tracks)for(o=g.tracks,l=0,n=o.length;n>l;l++)j=o[l],_.contains(h,j.album.name)||(h.push(j.album.name),e.push({name:j.album.name,art:_.first(j.album.images),backend:g.uri,model:"album"})),_.contains(i,_.first(j.artists).name)||(i.push(_.first(j.artists).name),f.push({name:_.first(j.artists).name,art:_.first(j.album.images),backend:g.uri,model:"artist"}));return c.artists=f,c.albums=e,a.$apply(function(){return b(e,f)})})},window.mopidy=e=new Mopidy({webSocketUrl:"development"===b.name?"ws://"+location.hostname+":6680/mopidy/ws":!1}),d("state:online",function(){return a.isConnected=!0}),d("state:offline",function(){return a.isConnected=!1}),{isConnected:function(){return a.isConnected},on:d,off:e.off,emit:e.emit,"native":e,getCurrentTrack:function(b){return e.playback.getCurrentTrack().then(function(c){return a.$apply(function(){return b(c)})})},getCurrentTlTrack:function(b){return e.playback.getCurrentTlTrack().then(function(c){return a.$apply(function(){return b(c)})})},changeTrack:function(a){return e.playback.changeTrack(a)},getTracklistPosition:function(b,c){return e.tracklist.index(b).then(function(b){return a.$apply(function(){return c(b)})})},getTracklist:function(b){return e.tracklist.getTlTracks().then(function(c){return a.$apply(function(){return b(c)})})},getState:function(b){return e.playback.getState().then(function(c){return a.$apply(function(){return b(c)})})},getVolume:function(b){return e.playback.getVolume().then(function(c){return a.$apply(function(){return b(c)})})},getRandom:function(b){return e.tracklist.getRandom().then(function(c){return a.$apply(function(){return b(c)})})},getRepeat:function(b){return e.tracklist.getRepeat().then(function(c){return a.$apply(function(){return b(c)})})},getTimePosition:function(b){return e.playback.getTimePosition().then(function(c){return a.$apply(function(){return b(c)})})},getAlbums:function(a){return f(function(b){return a(b)})},getArtists:function(a){return f(function(b,c){return a(c)})}}}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlayerCtrl",["$scope","Mopidy","$timeout","$rootScope","$window",function(a,b,c,d,e){var f,g,h,i,j;return g=!1,a.loved=!1,i=function(b){return a.track_position_time=b,a.track_position=a.track_position_time/a.track_length*100,j()},j=function(){return"playing"===a.state?(c.cancel(g),g=c(function(){return i(a.track_position_time+1e3)},1e3)):c.cancel(g)},h=function(b){var c;return b?(a.track=b.name,a.artist=b.artists?b.artists[0].name:!1,a.album=b.album?b.album.name:!1,null!=b.album.images?(c=b.album.images[0],/sndcdn/.test(c)&&(c=c.replace("-large.jp","-t500x500.jp")),a.cover=c):a.cover=a.album&&a.artist?"/lux/cover?album="+e.encodeURIComponent(a.album)+"&artist="+e.encodeURIComponent(a.artist):a.artist?"/lux/cover?artist="+e.encodeURIComponent(a.artist)+"&track="+e.encodeURIComponent(a.track):!1,a.track_length=b.length?b.length:0):(a.album=!1,a.artist=!1,a.cover=!1,a.track=!1,a.track_length=0,a.track_position=0)},f=function(){return b.getRandom(function(b){return a.random=b}),b.getRepeat(function(b){return a.repeat=b})},b.on("event:optionsChanged",f),b.on("event:seeked",function(a){return c.cancel(g),i(a.time_position)}),b.on("event:playbackStateChanged",function(d){return c.cancel(g),a.state=d.new_state,b.getCurrentTrack(h),b.getTimePosition(i)}),b.on("state:online",function(){return b.getState(function(c){return a.state=c,b.getCurrentTrack(h),b.getTimePosition(i)}),f()}),a.play=function(){return b["native"].playback.play()},a.stop=function(){return c.cancel(g),b["native"].playback.stop()},a.pause=function(){return c.cancel(g),b["native"].playback.pause()},a.next=function(){return c.cancel(g),b["native"].playback.next()},a.prev=function(){return c.cancel(g),b["native"].playback.previous()},a.toggle_random=function(){return b["native"].tracklist.setRandom(!a.random)},a.toggle_repeat=function(){return b["native"].tracklist.setRepeat(!a.repeat)},a.switchmode=function(){return d.ui_state=!d.ui_state},a.toggle_love=function(){return a.loved=!a.loved},a.seek=function(c){var d;return d=c.offsetX/c.currentTarget.clientWidth*a.track_length,b["native"].playback.seek(d)}}])}.call(this),function(){"use strict";angular.module("newSrcApp").filter("totime",function(){return function(a){var b,c,d,e,f;return a?(f=(parseInt(a)/1e3).toFixed(0),c=~~(f/60),e=f%60,b=~~(f/3600),c=~~(f%3600/60),e=f%60,d="",b>0&&(d+=""+b+":"+(10>c?"0":"")),d+=""+c+":"+(10>e?"0":""),d+=""+e):"0:00"}})}.call(this),function(){"use strict";angular.module("newSrcApp").filter("uriEncode",["$window",function(a){return a.encodeURIComponent}])}.call(this);