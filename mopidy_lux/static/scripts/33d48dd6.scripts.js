(function(){"use strict";angular.module("newSrcApp",["ngSanitize","ngRoute","mgcrea.ngStrap","config","pasvaz.bindonce"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/playlist.html",controller:"PlaylistCtrl"}).when("/browse/",{templateUrl:"views/browse.html",controller:"BrowseCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","ENV",function(a,b){return a.toplayer=function(){return $("#wrapper").toggleClass("active"),a.ui_state=!a.ui_state},a.$watch("title",function(){return angular.element("head title").text("development"===b.name?"Lux("+b.build+") - "+a.title:"Lux - "+a.title)})}])}).call(this),angular.module("config",[]).constant("ENV",{name:"production",build:"1.0.0-15-ga3b0ef3"}),function(){"use strict";angular.module("newSrcApp").directive("bootswatch",function(){return{template:"<form><select>\n  <option ng-repeat=\"theme in ['amelia','cerulean','cosmo','cyborg','darkly','flatly','journal','lumen','readable','simplex','slate','spacelab','superhero','united','yeti']\" value=\"{{theme}}\">{{theme}}</option>\n</select></form>",restrict:"EA",link:function(a,b){return b.bind("change",function(a){return angular.element("head link:nth(0)").attr("href","//netdna.bootstrapcdn.com/bootswatch/3.1.1/"+a.target.value+"/bootstrap.min.css")})}}})}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SearchCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("DiscoverCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("BrowseCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlaylistCtrl",["$scope","Mopidy","$rootScope","$timeout",function(a,b,c,d){var e,f,g;return c.title="Playlist",e=!1,f=function(a){return d(function(){var b;return $("table tbody tr").removeClass("active"),b=$("table tbody tr:eq("+a+")").addClass("active"),b.length?$("body").animate({scrollTop:b.offset().top-100},800):void 0},100)},c.$watch("indexNow",function(a){return a>=0?f(a):void 0}),g=function(){return d.cancel(e),e=d(function(){return b.getTracklist(function(b){return a.tracks=b,f(c.indexNow)})},100)},a.pause=function(){return b["native"].playback.pause()},a.toggleMenu=function(){return $("#wrapper").toggleClass("active")},a.play=function(a){return b.changeTrack(a),b["native"].playback.play()},a.clear=function(){return b["native"].tracklist.clear()},a.$on("mopidy:tracklist_changed",g),a.$on("mopidy:online",g),c.isConnected?g():void 0}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SettingsCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").factory("Mopidy",["$rootScope","ENV","$log",function(a,b,c){var d,e,f,g;return d={albums:!1,artists:!1},e=function(b,c){return f.on(b,function(b){return a.$apply(function(){return c(b)})})},g=function(b){return d.artists&&d.albums?b(d.albums,d.artists):f.library.search().then(function(c){var e,f,g,h,i,j,k,l,m,n,o;for(e=[],f=[],k=0,m=c.length;m>k;k++)if(g=c[k],h=[],i=[],g.tracks)for(o=g.tracks,l=0,n=o.length;n>l;l++)j=o[l],_.contains(h,j.album.name)||(h.push(j.album.name),e.push({name:j.album.name,art:_.first(j.album.images),backend:g.uri,model:"album"})),_.contains(i,_.first(j.artists).name)||(i.push(_.first(j.artists).name),f.push({name:_.first(j.artists).name,art:_.first(j.album.images),backend:g.uri,model:"artist"}));return d.artists=f,d.albums=e,a.$apply(function(){return b(e,f)})})},window.mopidy=f=new Mopidy({webSocketUrl:"development"===b.name?"ws://"+location.hostname+":6680/mopidy/ws":!1,callingConvention:"by-position-or-by-name"}),e("websocket:incomingMessage",function(b){var d,e;try{if(d=JSON.parse(b.data),d.hasOwnProperty("event"))return c.info("mopidy:"+d.event,d),a.$broadcast("mopidy:"+d.event,d)}catch(f){if(e=f,e instanceof SyntaxError)return c.warn("WebSocket message parsing failed. Message was: "+b.data);throw e}}),e("state:online",function(){return a.isConnected=!0,a.$broadcast("mopidy:online")}),e("state:offline",function(){return a.isConnected=!1,a.$broadcast("mopidy:offline")}),a.$on("mopidy:track_index",function(b,c){return a.indexNow=c}),a.$on("mopidy:track_playback_started",function(b,c){return a.indexNow=c.tl_track.tlid}),{isConnected:function(){return a.isConnected},on:e,off:f.off,emit:f.emit,"native":f,getCurrentTrack:function(b){return f.playback.getCurrentTrack().then(function(c){return a.$apply(function(){return b(c)})})},getCurrentTlTrack:function(b){return f.playback.getCurrentTlTrack().then(function(c){return a.$apply(function(){return b(c)})})},changeTrack:function(a){return f.playback.changeTrack([a])},getTracklistPosition:function(b,c){return f.tracklist.index(b).then(function(b){return a.$apply(function(){return c(b)})})},getTracklist:function(b){return f.tracklist.getTlTracks().then(function(c){return a.$apply(function(){return b(c)})})},getState:function(b){return f.playback.getState().then(function(c){return a.$apply(function(){return b(c)})})},getVolume:function(b){return f.playback.getVolume().then(function(c){return a.$apply(function(){return b(c)})})},getRandom:function(b){return f.tracklist.getRandom().then(function(c){return a.$apply(function(){return b(c)})})},getRepeat:function(b){return f.tracklist.getRepeat().then(function(c){return a.$apply(function(){return b(c)})})},getTimePosition:function(b){return f.playback.getTimePosition().then(function(c){return a.$apply(function(){return b(c)})})},getAlbums:function(a){return g(function(b){return a(b)})},getArtists:function(a){return g(function(b,c){return a(c)})}}}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlayerCtrl",["$scope","Mopidy","$timeout","$rootScope","$window","$log",function(a,b,c,d,e,f){var g,h,i,j,k;return h=!1,a.loved=!1,a.volume_level=0,j=function(b){return a.track_position_time=b,a.track_position=a.track_position_time/a.track_length*100,k()},k=function(){return"playing"===a.state?(c.cancel(h),h=c(function(){return j(a.track_position_time+1e3)},1e3)):c.cancel(h)},i=function(b){var c;return null!=b.tlid&&d.$broadcast("mopidy:track_index",b.tlid),null!=b.track&&(b=b.track),b?(a.track=b.name,a.artist=b.artists?b.artists[0].name:!1,a.album=b.album?b.album.name:!1,null!=b.album.images?(c=b.album.images[0],/sndcdn/.test(c)&&(c=c.replace("-large.jp","-t500x500.jp")),a.cover=c):a.cover=a.album&&a.artist?"/lux/cover?album="+e.encodeURIComponent(a.album)+"&artist="+e.encodeURIComponent(a.artist):a.artist?"/lux/cover?artist="+e.encodeURIComponent(a.artist)+"&track="+e.encodeURIComponent(a.track):!1,a.track_length=b.length?b.length:0):(a.album=!1,a.artist=!1,a.cover=!1,a.track=!1,a.track_length=0,a.track_position=0)},g=function(){return b.getRandom(function(b){return a.random=b}),b.getRepeat(function(b){return a.repeat=b})},a.$on("mopidy:options_changed",g),a.$on("mopidy:seeked",function(a,b){return c.cancel(h),j(b.time_position)}),a.$on("mopidy:volume_changed",function(b,c){return a.volume_level=c.volume}),a.$on("mopidy:playback_state_changed",function(d,e){return c.cancel(h),a.state=e.new_state,b.getTimePosition(j)}),a.$on("mopidy:track_playback_started",function(a,b){return i(b.tl_track.track)}),a.$on("mopidy:online",function(){return b.getState(function(c){return a.state=c,b.getCurrentTlTrack(i),b.getTimePosition(j)}),g()}),a.play=function(){return b["native"].playback.play()},a.stop=function(){return c.cancel(h),b["native"].playback.stop()},a.pause=function(){return c.cancel(h),b["native"].playback.pause()},a.next=function(){return c.cancel(h),b["native"].playback.next()},a.prev=function(){return c.cancel(h),b["native"].playback.previous()},a.toggle_volume=function(){return b["native"].playback.getVolume().then(function(b){return a.$apply(function(){return f.info(b),a.volume_level=b})}),a.volume=!a.volume},a.toggle_random=function(){return b["native"].tracklist.setRandom([!a.random])},a.toggle_repeat=function(){return b["native"].tracklist.setRepeat([!a.repeat])},a.switchmode=function(){return d.ui_state=!d.ui_state},a.toggle_love=function(){return a.loved=!a.loved},a.seek=function(c){var d,e;return e=c.currentTarget.clientWidth,d=c.offsetX/e*a.track_length,b["native"].playback.seek([d])},a.set_volume=function(a){var c,d;return d=a.currentTarget.clientWidth,c=a.offsetX/d*100,b["native"].playback.setVolume([c])}}])}.call(this),function(){"use strict";angular.module("newSrcApp").filter("totime",function(){return function(a){var b,c,d,e,f;return f=(parseInt(a)/1e3).toFixed(0),f>0?(c=~~(f/60),e=f%60,b=~~(f/3600),c=~~(f%3600/60),e=f%60,d="",b>0&&(d+=""+b+":"+(10>c?"0":"")),d+=""+c+":"+(10>e?"0":""),d+=""+e):"âˆž"}})}.call(this),function(){"use strict";angular.module("newSrcApp").filter("uriEncode",["$window",function(a){return a.encodeURIComponent}])}.call(this);