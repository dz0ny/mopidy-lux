(function(){"use strict";angular.module("newSrcApp",["ngSanitize","ngRoute","mgcrea.ngStrap"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/playlist.html",controller:"PlaylistCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){return a.toplayer=function(){return $("#wrapper").toggleClass("active"),a.ui_state=!a.ui_state},a.$watch("description",function(){return angular.element("head meta[name=description]").attr("content",a.description)}),a.$watch("title",function(){return angular.element("head title").text("Lux - "+a.title)})}])}).call(this),function(){"use strict";angular.module("newSrcApp").directive("bootswatch",function(){return{template:"<form><select>\n  <option ng-repeat=\"theme in ['amelia','cerulean','cosmo','cyborg','darkly','flatly','journal','lumen','readable','simplex','slate','spacelab','superhero','united','yeti']\" value=\"{{theme}}\">{{theme}}</option>\n</select></form>",restrict:"EA",link:function(a,b){return b.bind("change",function(a){return angular.element("head link:nth(0)").attr("href","//netdna.bootstrapcdn.com/bootswatch/3.1.1/"+a.target.value+"/bootstrap.min.css")})}}})}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SearchCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("DiscoverCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("BrowseCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlaylistCtrl",["$scope","Mopidy","$rootScope","$log",function(a,b,c,d){var e,f,g;return c.title="Playlist",e=function(){return b.getCurrentTrack(function(b){return a.now_playing=b.uri,d.info(b.uri)}),b.getState(function(b){return a.state=b}),b.getTracklistPosition(function(b){return console.log(b),a.current_track=b})},g=function(){return b.getTracklist(function(b){return a.tracks=b,e()})},a.play=function(c){return b.changeTrack(c),"playing"!==a.state?b["native"].playback.play():void 0},f=function(){return g(),e()},b.on("event:tracklistChanged",g),b.on("event:playbackStateChanged",e),b.on("state:online",f),c.isConnected&&f(),a.$on("$destroy",function(){return b.off("event:tracklistChanged",g),b.off("event:playbackStateChanged",e),b.off("state:online",f)})}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("SettingsCtrl",["$scope",function(a){return a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}])}.call(this),function(){"use strict";angular.module("newSrcApp").factory("Mopidy",["$rootScope",function(a){var b,c,d,e,f;return b={albums:!1,artists:!1},c=function(b,c){return d.on(b,function(b){return a.$apply(function(){return c(b)})})},f=function(a){return"http://coverartarchive.org/release/"+a+"/front"},e=function(c){return b.artists&&b.albums?c(b.albums,b.artists):d.library.search().then(function(d){var e,f,g,h,i,j,k,l,m,n,o;for(e=[],f=[],k=0,m=d.length;m>k;k++)if(g=d[k],h=[],i=[],g.tracks)for(o=g.tracks,l=0,n=o.length;n>l;l++)j=o[l],_.contains(h,j.album.name)||(h.push(j.album.name),e.push({name:j.album.name,art:_.first(j.album.images),backend:g.uri,model:"album"})),_.contains(i,_.first(j.artists).name)||(i.push(_.first(j.artists).name),f.push({name:_.first(j.artists).name,art:_.first(j.album.images),backend:g.uri,model:"artist"}));return b.artists=f,b.albums=e,a.$apply(function(){return c(e,f)})})},d=new Mopidy({webSocketUrl:"ws://localhost:6680/mopidy/ws"}),window.mop=d,c("state:online",function(){return a.isConnected=!0}),c("state:offline",function(){return a.isConnected=!1}),{isConnected:function(){return a.isConnected},on:c,off:d.off,emit:d.emit,"native":d,getCurrentTrack:function(b){return d.playback.getCurrentTrack().then(function(c){return a.$apply(function(){return b(c)})})},changeTrack:function(a){return d.playback.changeTrack(a)},getTracklistPosition:function(b){return d.tracklist.index().then(function(c){return a.$apply(function(){return b(c)})})},getTracklist:function(b){return d.tracklist.getTlTracks().then(function(c){return a.$apply(function(){return b(c)})})},getState:function(b){return d.playback.getState().then(function(c){return a.$apply(function(){return b(c)})})},getVolume:function(b){return d.playback.getVolume().then(function(c){return a.$apply(function(){return b(c)})})},getRandom:function(b){return d.tracklist.getRandom().then(function(c){return a.$apply(function(){return b(c)})})},getRepeat:function(b){return d.tracklist.getRepeat().then(function(c){return a.$apply(function(){return b(c)})})},getTimePosition:function(b){return d.playback.getTimePosition().then(function(c){return a.$apply(function(){return b(c)})})},getAlbums:function(a){return e(function(b){return a(b)})},getArtists:function(a){return e(function(b,c){return a(c)})}}}])}.call(this),function(){"use strict";angular.module("newSrcApp").controller("PlayerCtrl",["$scope","Mopidy","$timeout","$log","$rootScope",function(a,b,c,d,e){var f,g,h,i,j;return g=!1,i=function(b){return a.track_position_time=b,a.track_position=a.track_position_time/a.track_length*100,j()},j=function(){return"playing"===a.state?(c.cancel(g),g=c(function(){return i(a.track_position_time+1e3)},1e3)):c.cancel(g)},h=function(b){var c;return b?(a.track=b.name,a.artist=b.artists?b.artists[0].name:!1,a.album=b.album?b.album.name:!1,null!=b.album.images?(c=b.album.images[0],/sndcdn/.test(c)&&(c=c.replace("-large.jp","-t500x500.jp")),a.cover=c):a.cover=!1,a.track_length=b.length?b.length:0):(a.album=!1,a.artist=!1,a.cover=!1,a.track=!1,a.track_length=0,a.track_position=0)},f=function(){return b.getRandom(function(b){return a.random=b,d.info(b)}),b.getRepeat(function(b){return a.repeat=b,d.info(b)})},b.on("event:optionsChanged",f),b.on("event:seeked",function(a){return i(a.time_position)}),b.on("event:playbackStateChanged",function(c){return d.info(c),a.state=c.new_state,b.getCurrentTrack(h),b.getTimePosition(i)}),b.on("state:online",function(){return b.getState(function(c){return a.state=c,b.getCurrentTrack(h),b.getTimePosition(i)}),f()}),a.play=function(){return b["native"].playback.play()},a.stop=function(){return b["native"].playback.stop()},a.pause=function(){return b["native"].playback.pause()},a.next=function(){return b["native"].playback.next()},a.prev=function(){return b["native"].playback.previous()},a.toggle_random=function(){return b["native"].tracklist.setRandom(!a.random)},a.toggle_repeat=function(){return b["native"].tracklist.setRepeat(!a.repeat)},a.switchmode=function(){return e.ui_state=!e.ui_state}}])}.call(this);